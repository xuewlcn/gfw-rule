port: 7890
socks-port: 7891
redir-port: 7892
allow-lan: false
mode: rule
log-level: silent
external-controller: '0.0.0.0:9090'
secret: ''
dns:
  enable: true
  ipv6: false
  listen: '0.0.0.0:53'
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  nameserver:
    - 114.114.114.114
    - 'tcp://223.5.5.5'
  fallback:
    - 'tls://223.5.5.5:853'
    - 'https://223.5.5.5/dns-query'
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4

http:
  mitm:
    - sub.store
  script:
    - match: ^https?:\/\/sub\.store
      name: sub-store
      type: request
      require-body: true
      timeout: 120
script-providers:
  sub-store:
    url: https://raw.githubusercontent.com/Peng-YM/Sub-Store/master/backend/sub-store.min.js
    interval: 86400

proxy-providers:
  nfcloud:
    type: http
    path: ./profiles/proxies/nfcloud.yaml
    url: https://api.v1.mk/sub?target=clash&url=https%3A%2F%2Fsub.nfol.xyz%2Flink%2F2Hpoi11WFqNyRnmD%3Fclash%3D2&insert=false&config=https%3A%2F%2Fraw.githubusercontent.com%2FMeilieage%2Fwebcdn%2Fmain%2Frule%2FArea_Media_NoAuto.ini&emoji=true&list=true&udp=false&tfo=false&expand=true&scv=false&fdn=false&sort=false&new_name=true
    interval: 3600
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300  
  #https://openit.ml/Clash.yaml    
  openit:
    type: http
    path: ./profiles/proxies/openit.yaml
    url: https://api.v1.mk/sub?target=clash&url=https%3A%2F%2Fopenit.ml%2FClash.yaml&insert=false&config=https%3A%2F%2Fraw.githubusercontent.com%2FMeilieage%2Fwebcdn%2Fmain%2Frule%2FArea_Media_NoAuto.ini&emoji=true&list=true&udp=false&tfo=false&expand=true&scv=false&fdn=false&sort=false&new_name=true
    interval: 3600
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
  #https://openit.ml/Clash.yaml    
  justmysocks:
    type: http
    path: ./profiles/proxies/justmysocks.yaml
    url: https://api.v1.mk/sub?target=clash&url=https%3A%2F%2Fjmssub.net%2Fmembers%2Fgetsub.php%3Fservice%3D511879%26id%3D6c5a7b0f-f81c-4c07-8323-9e91990ddee2%26usedomains%3D1&insert=false&config=https%3A%2F%2Fraw.githubusercontent.com%2FMeilieage%2Fwebcdn%2Fmain%2Frule%2FArea_Media_NoAuto.ini&emoji=true&list=true&udp=false&tfo=false&expand=true&scv=false&fdn=false&sort=false&new_name=true
    interval: 3600
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300


proxy-groups:
  - 
    name: 🔰国外流量
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - DIRECT
      - ♻️自动选择
  - 
    name: ♻️自动选择
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 3600
    use:
      - justmysocks
      - nfcloud
  -
    name: 🍎苹果服务
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接
  -
    name: 💻微软服务
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接
  -
    name: ✈️Telegram
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
  -
    name: 🎬Youtube
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接
  -
    name: 🎬Netflix
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接
  -
    name: 🎬哔哩哔哩
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接
  -
    name: 🎬国外媒体
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接  
  -
    name: 🛠谷歌服务
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接
  -
    name: ⚓️其他流量
    type: select
    use:
      - justmysocks
      - nfcloud
      - openit
    proxies:
      - 🔰国外流量
      - ♻️自动选择
      - 🚀直接连接
  -
    name: 🚀直接连接
    type: select
    proxies:
      - DIRECT

rule-providers:
  Proxy:
    type: http
    behavior: domain
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Proxy/Proxy_Domain.yaml"
    path: ./ruleset/Proxy_Domain.yaml
    interval: 86400

#  Advertising:
#    type: http
#    behavior: domain
#    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Advertising/Advertising_Domain.yaml"
#    path: ./ruleset/Advertising_Domain.yaml
#    interval: 86400

  Apple:
    type: http
    behavior: classical
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple.yaml"
    path: ./ruleset/Apple.yaml
    interval: 86400

  Telegram:
    type: http
    behavior: classical
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml"
    path: ./ruleset/Telegram.yaml
    interval: 86400

  YouTube:
    type: http
    behavior: classical
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml"
    path: ./ruleset/YouTube.yaml
    interval: 86400

  Netflix:
    type: http
    behavior: classical
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml"
    path: ./ruleset/Netflix.yaml
    interval: 86400

  Microsoft:
    type: http
    behavior: classical
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml"
    path: ./ruleset/Microsoft.yaml
    interval: 86400

  BiliBili:
    type: http
    behavior: classical
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BiliBili/BiliBili.yaml"
    path: ./ruleset/BiliBili.yaml
    interval: 86400
    
  Google:
    type: http
    behavior: classical
    url: "https://ghproxy.com/https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml"
    path: ./ruleset/Google.yaml
    interval: 86400
    
rules:
  # 自定义规则优先
  - IP-CIDR,93.95.226.151/32,⚓️其他流量
  - IP-CIDR,120.29.217.52/32,⚓️其他流量
  - IP-CIDR,185.175.58.104/32,⚓️其他流量
  - DOMAIN-SUFFIX,safepal.io,⚓️其他流量
  - DOMAIN-SUFFIX,isafepal.com,⚓️其他流量
  - DOMAIN-SUFFIX,2047.one,⚓️其他流量
  - DOMAIN-SUFFIX,okx.com,⚓️其他流量
  - DOMAIN-SUFFIX,nfcloud.one,⚓️其他流量  
  - DOMAIN-SUFFIX,1lib.domains,⚓️其他流量

  # 下面的远程规则
  - RULE-SET,Apple,🍎苹果服务
  - RULE-SET,Telegram,✈️Telegram
  - RULE-SET,YouTube,🎬Youtube
  - RULE-SET,Netflix,🎬Netflix
  - RULE-SET,Microsoft,💻微软服务
  - RULE-SET,BiliBili,🎬哔哩哔哩
  - RULE-SET,Google,🛠谷歌服务
  - RULE-SET,Proxy,🔰国外流量
  - MATCH,DIRECT
